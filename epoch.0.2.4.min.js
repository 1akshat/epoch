(function(f){var h,d=/[-+,> ]/;f([],h=function(b,e){function a(e){function m(){l&&(n&&l!=n)&&(n==e&&(k||(k=d.test(q)&&b.createDocumentFragment()))||n).insertBefore(l,t||null)}for(var k,p,t,n,l,h=arguments,f=h[0],v=0;v<h.length;v++){var q=h[v];if("object"==typeof q){p=!1;if(q instanceof Array){l=b.createDocumentFragment();for(var r=0;r<q.length;r++)l.appendChild(a(q[r]));q=l}if(q.nodeType)l=q,m(),n=q,t=0;else for(r in q)l[r]=q[r]}else if(p)p=!1,l.appendChild(b.createTextNode(q));else{1>v&&(e=null);
p=!0;if(f=q.replace(c,function(c,d,k,p,f,r){d&&(m(),"-"==d||"+"==d?(n=(t=l||n).parentNode,l=null,"+"==d&&(t=t.nextSibling)):("<"==d?n=l=(l||n).parentNode:(","==d?n=e:l&&(n=l),l=null),t=0),l&&(n=l));if((c=!k&&p)||!l&&(k||f))"$"==c?(c=h[++v],n.appendChild(b.createTextNode(c))):(c=c||a.defaultTag,(d=u&&h[v+1]&&h[v+1].name)&&(c="<"+c+' name="'+d+'">'),l=w&&~(g=c.indexOf("|"))?b.createElementNS(w[c.slice(0,g)],c.slice(g+1)):b.createElement(c));if(k)if("$"==p&&(p=h[++v]),"#"==k)l.id=p;else if(d=(c=l.className)&&
(" "+c+" ").replace(" "+p+" "," "),"."==k)l.className=c?(d+p).substring(1):p;else if("!"==q){var y;u?a("div",l,"<").innerHTML="":(y=l.parentNode)&&y.removeChild(l)}else d=d.substring(1,d.length-1),d!=c&&(l.className=d);f&&("$"==r&&(r=h[++v]),"style"==f?l.style.cssText=r:(k="!"==f.charAt(0)?(f=f.substring(1))&&"removeAttribute":"setAttribute",r=""===r?f:r,w&&~(g=f.indexOf("|"))?l[k+"NS"](w[f.slice(0,g)],f.slice(g+1),r):l[k](f,r)));return""}))throw new SyntaxError("Unexpected char "+f+" in "+q);m();
n=f=l||n}}e&&k&&e.appendChild(k);return f}d=e||d;var c=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,g,w=!1;b=b||document;var u="object"==typeof b.createElement;a.addNamespace=function(a,c){b.createElementNS?(w||(w={}))[a]=c:b.namespaces.add(a,c)};a.defaultTag="div";a.forDocument=h;return a})})(function(f,h,d){d=d||h;"function"===typeof define?define([],function(){return d()}):"undefined"==typeof window?require("./node-html")(module,d):put=d()});
(function(){var f,h,d,b={}.hasOwnProperty,e=function(a,c){function g(){this.constructor=a}for(var w in c)b.call(c,w)&&(a[w]=c[w]);g.prototype=c.prototype;a.prototype=new g;a.__super__=c.prototype;return a};null==window.Epoch&&(window.Epoch={});null==(d=window.Epoch).Chart&&(d.Chart={});null==(d=window.Epoch).Time&&(d.Time={});null==(d=window.Epoch).Util&&(d.Util={});null==(d=window.Epoch).Formats&&(d.Formats={});Epoch.isArray=function(a){return"array"===$.type(a)};Epoch.isObject=function(a){return"object"===
$.type(a)};Epoch.warn=function(a){return(console.warn||console.log)("Warning: "+a)};Epoch.Util.copy=function(a){var c,g,b;if(null==a)return null;c={};for(g in a)b=a[g],c[g]=b;return c};Epoch.Util.defaults=function(a,c){var g,b;b=Epoch.Util.copy(a);for(g in c)null!=a[g]&&null!=c[g]?!Epoch.isArray(a[g])&&Epoch.isObject(a[g])&&Epoch.isObject(c[g])?b[g]=Epoch.Util.defaults(a[g],c[g]):b[g]=a[g]:b[g]=null!=a[g]?a[g]:c[g];return b};Epoch.Util.formatSI=function(a,c,g){var b,u,e,d;null==c&&(c=1);null==g&&
(g=!1);if(1E3>a)return a;d="KMGTPEZY".split("");for(u in d)if(e=d[u],b=Math.pow(10,3*((u|0)+1)),a>=b&&a<Math.pow(10,3*((u|0)+2))){a/=b;if((a|0)!==a||g)a=a.toFixed(c);return""+a+" "+e}};Epoch.Util.dasherize=function(a){return a.replace("\n","").replace(/\s+/,"-").toLowerCase()};Epoch.Util.domain=function(a,c){var g,b,u,e,d,k,p,f;null==c&&(c="x");u={};e=0;for(k=a.length;e<k;e++)for(g=a[e],f=g.values,d=0,p=f.length;d<p;d++)g=f[d],u[g[c]]=!0;e=[];for(b in u)e.push(b);return e};Epoch.Formats.regular=function(a){return a};
Epoch.Formats.si=function(a){return Epoch.Util.formatSI(a)};Epoch.Formats.percent=function(a){return(100*a).toFixed(1)+"%"};h=d3.time.format("%I:%M:%S %p");Epoch.Formats.seconds=function(a){return h(new Date(1E3*a))};Epoch.Events=function(){function a(){this._events={}}a.prototype.on=function(a,g){var b;if(null!=g)return null==(b=this._events)[a]&&(b[a]=[]),this._events[a].push(g)};a.prototype.off=function(a,g){var b,e;if(Epoch.isObject(this._events[a])){if(null==g)return delete this._events[a];for(e=
[];0<=(b=this._events[a].indexOf(g));)e.push(this._events[a].splice(b,1));return e}};a.prototype.trigger=function(a){var g,b,e,d,m,k,p;if(Epoch.isObject(this._events[a])){g=function(){var a,c,g;g=[];e=a=1;for(c=arguments.length;1<=c?a<c:a>c;e=1<=c?++a:--a)g.push(arguments[e]);return g}.apply(this,arguments);k=this._events[a];p=[];d=0;for(m=k.length;d<m;d++)b=k[d],p.push(b.apply(this,g));return p}};return a}();Epoch.Chart.Base=function(a){function c(a){this.options=a;this.setData(this.options.data||
[]);null!=this.options.el&&(this.el=$(this.options.el));this.width=this.options.width;this.height=this.options.height;null!=this.el?(null==this.width&&(this.width=$(this.el).width()),null==this.height&&(this.height=$(this.el).height())):(null==this.width&&(this.width=g.dimensions.width),null==this.height&&(this.height=g.dimensions.height))}var g;e(c,a);g={dimensions:{width:320,height:240}};c.prototype.setData=function(a){var c,g,b,e,d;c=1;e=0;for(d=a.length;e<d;e++)b=a[e],g=["layer"],g.push("category"+
c),null!=b.label&&g.push(Epoch.Util.dasherize(b.label)),b.className=g.join(" "),c++;return this.data=a};c.prototype.update=function(a,c){null==c&&(c=!0);this.setData(a);if(c)return this.draw()};c.prototype.draw=function(){};c.prototype.extent=function(a){return[d3.min(this.data,function(c){return d3.min(c.values,a)}),d3.max(this.data,function(c){return d3.max(c.values,a)})]};return c}(Epoch.Events);Epoch.Chart.SVG=function(a){function c(a){this.options=null!=a?a:{};c.__super__.constructor.call(this,
this.options);this.svg=null!=this.el?d3.select(this.el.get(0)).append("svg"):d3.select(document.createElement("svg"));this.svg.attr("width",this.width).attr("height",this.height)}e(c,a);return c}(Epoch.Chart.Base);Epoch.Chart.Canvas=function(a){function c(a){this.options=null!=a?a:{};c.__super__.constructor.call(this,this.options);this.canvas=$("<canvas></canvas>");this.canvas.attr("width",this.width).attr("height",this.height);null!=this.el&&this.el.append(this.canvas);this.ctx=this.canvas.get(0).getContext("2d")}
e(c,a);c.prototype.getStyles=function(a){return f.getStyles(a,this.el)};return c}(Epoch.Chart.Base);f=function(){function a(){}a.cache={};a.styleList=["fill","stroke","stroke-width"];a.container=null;a.load=function(){$("body").append('<div id="_canvas_css_reference"></div>');return a.container=$("#_canvas_css_reference","body")};a.containerId=function(a){return""+a.attr("id")+"."+a.attr("class")};a.getSVG=function(c){var g,b;b=a.containerId(c);g=a.svgElements[b];null==g&&(c=$(c).clone().html("<svg></svg>"),
a.svgContainer.append(c),g=a.svgElements[b]=$("svg",c));return g};a.getStyles=function(c,g){var b,e,d,m,k,f,h,n;e=""+a.containerId(g)+"__"+c;b=a.cache[e];if(null!=b)return b;b=$(g).clone().html("<svg></svg>");b.removeAttr("style");a.container.append(b);h=$("svg",b);m=c.split(/\s+/);for(k=f=put(m.shift());m.length;)d=put(m.shift()),k.appendChild(d),k=d;h.html(f);m=$(c,h);k={};n=a.styleList;f=0;for(h=n.length;f<h;f++)d=n[f],k[d]=m.css(d);a.cache[e]=k;$(b,a.container).remove();return k};return a}();
$(f.load);Epoch.Chart.Plot=function(a){function c(a){var e,d,m,f;this.options=null!=a?a:{};a=Epoch.Util.copy(this.options.margins)||{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,b));this.margins={};f=["top","right","bottom","left"];d=0;for(m=f.length;d<m;d++)e=f[d],this.margins[e]=this.options.margins[e],null!=a[e]||this.hasAxis(e)||(this.margins[e]=6);this.svg=this.svg.append("g").attr("transform","translate("+this.margins.left+", "+this.margins.top+")")}var b;
e(c,a);b={margins:{top:25,right:50,bottom:25,left:50},axes:["left","bottom"],ticks:{top:14,bottom:14,left:5,right:5},tickFormats:{top:Epoch.Formats.regular,bottom:Epoch.Formats.regular,left:Epoch.Formats.si,right:Epoch.Formats.si}};c.prototype.setTickFormat=function(a,c){return this.options.tickFormats[a]=c};c.prototype.hasAxis=function(a){return-1<this.options.axes.indexOf(a)};c.prototype.innerWidth=function(){return this.width-(this.margins.left+this.margins.right)};c.prototype.innerHeight=function(){return this.height-
(this.margins.top+this.margins.bottom)};c.prototype.x=function(){return d3.scale.linear().domain(this.extent(function(a){return a.x})).range([0,this.innerWidth()])};c.prototype.y=function(){return d3.scale.linear().domain(this.extent(function(a){return a.y})).range([this.innerHeight(),0])};c.prototype.bottomAxis=function(){return d3.svg.axis().scale(this.x()).orient("bottom").ticks(this.options.ticks.bottom).tickFormat(this.options.tickFormats.bottom)};c.prototype.topAxis=function(){return d3.svg.axis().scale(this.x()).orient("top").ticks(this.options.ticks.top).tickFormat(this.options.tickFormats.top)};
c.prototype.leftAxis=function(){return d3.svg.axis().scale(this.y()).orient("left").ticks(this.options.ticks.left).tickFormat(this.options.tickFormats.left)};c.prototype.rightAxis=function(){return d3.svg.axis().scale(this.y()).orient("right").ticks(this.options.ticks.right).tickFormat(this.options.tickFormats.right)};c.prototype.draw=function(){c.__super__.draw.call(this);return this._axesDrawn?this.redrawAxes():this.drawAxes()};c.prototype.redrawAxes=function(){this.hasAxis("bottom")&&this.svg.selectAll(".x.axis.bottom").transition().duration(500).ease("linear").call(this.bottomAxis());
this.hasAxis("top")&&this.svg.selectAll(".x.axis.top").transition().duration(500).ease("linear").call(this.topAxis());this.hasAxis("left")&&this.svg.selectAll(".y.axis.left").transition().duration(500).ease("linear").call(this.leftAxis());if(this.hasAxis("right"))return this.svg.selectAll(".y.axis.right").transition().duration(500).ease("linear").call(this.rightAxis())};c.prototype.drawAxes=function(){this.hasAxis("bottom")&&this.svg.append("g").attr("class","x axis bottom").attr("transform","translate(0, "+
this.innerHeight()+")").call(this.bottomAxis());this.hasAxis("top")&&this.svg.append("g").attr("class","x axis top").call(this.topAxis());this.hasAxis("left")&&this.svg.append("g").attr("class","y axis left").call(this.leftAxis());this.hasAxis("right")&&this.svg.append("g").attr("class","y axis right").attr("transform","translate("+this.innerWidth()+", 0)").call(this.rightAxis());return this._axesDrawn=!0};return c}(Epoch.Chart.SVG)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Chart.Area=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}h(b,d);b.prototype.y=function(){var b,a,c,g,d,u,f;b=[];u=this.data;g=0;for(d=u.length;g<d;g++)for(a in c=u[g],f=c.values,f)c=f[a],null!=b[a]&&(b[a]+=c.y),null==b[a]&&(b[a]=c.y);return d3.scale.linear().domain([0,
d3.max(b)]).range([this.height-this.margins.top-this.margins.bottom,0])};b.prototype.draw=function(){var e,a,c,g;a=[this.x(),this.y()];c=a[0];g=a[1];e=d3.svg.area().x(function(a){return c(a.x)}).y0(function(a){return g(a.y0)}).y1(function(a){return g(a.y0+a.y)});d3.layout.stack().values(function(a){return a.values})(this.data);a=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});a.select(".area").transition().duration(500).attr("d",function(a){return e(a.values)});a.enter().append("g").attr("class",
function(a){return a.className});a.append("path").attr("class","area").attr("d",function(a){return e(a.values)});a.exit().transition().duration(750).style("opacity",0).remove();return b.__super__.draw.call(this)};return b}(Epoch.Chart.Plot)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Chart.Bar=function(d){function b(a){this.options=null!=a?a:{};b.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,e))}var e;h(b,d);e={style:"grouped"};b.prototype.x=function(){return d3.scale.ordinal().domain(Epoch.Util.domain(this.data)).rangeRoundBands([0,this.innerWidth()],
0.1)};b.prototype.x1=function(a){var c;return d3.scale.ordinal().domain(function(){var a,b,e,d;e=this.data;d=[];a=0;for(b=e.length;a<b;a++)c=e[a],d.push(c.label);return d}.call(this)).rangeRoundBands([0,a.rangeBand()],0.08)};b.prototype.y=function(){var a;a=this.extent(function(a){return a.y});a[0]=Math.min(0,a[0]);return d3.scale.linear().domain(a).range([this.height-this.margins.top-this.margins.bottom,0])};b.prototype._remapData=function(){var a,c,b,e,d,f,m,k,h,t,n,l;d={};n=this.data;f=0;for(k=
n.length;f<k;f++)for(e=n[f],a="bar "+e.className.replace(/\s*layer\s*/,""),l=e.values,m=0,h=l.length;m<h;m++)c=l[m],null==d[t=c.x]&&(d[t]=[]),d[c.x].push({label:e.label,y:c.y,className:a});c=[];for(b in d)a=d[b],c.push({group:b,values:a});return c};b.prototype.draw=function(){var a,c,g,e,d,f;a=[this.x(),this.y()];e=a[0];f=a[1];d=this.x1(e);c=this.height-this.margins.top-this.margins.bottom;a=this._remapData();a=this.svg.selectAll(".layer").data(a,function(a){return a.group});a.transition().duration(750).attr("transform",
function(a){return"translate("+e(a.group)+", 0)"});a.enter().append("g").attr("class","layer").attr("transform",function(a){return"translate("+e(a.group)+", 0)"});g=a.selectAll("rect").data(function(a){return a.values});g.transition().duration(600).attr("x",function(a){return d(a.label)}).attr("y",function(a){return f(a.y)}).attr("width",d.rangeBand()).attr("height",function(a){return c-f(a.y)});g.enter().append("rect").attr("class",function(a){return a.className}).attr("x",function(a){return d(a.label)}).attr("y",
function(a){return f(a.y)}).attr("width",d.rangeBand()).attr("height",function(a){return c-f(a.y)});g.exit().transition().duration(150).style("opacity","0").remove();a.exit().transition().duration(750).style("opacity","0").remove();return b.__super__.draw.call(this)};return b}(Epoch.Chart.Plot)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Chart.Line=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}h(b,d);b.prototype.line=function(){var b,a,c;c=[this.x(),this.y()];b=c[0];a=c[1];return d3.svg.line().x(function(a){return b(a.x)}).y(function(c){return a(c.y)})};b.prototype.draw=function(){var e,a;a=[this.x(),
this.y(),this.line()][2];e=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});e.select(".line").transition().duration(500).attr("d",function(c){return a(c.values)});e.enter().append("g").attr("class",function(a){return a.className}).append("path").attr("class","line").attr("d",function(c){return a(c.values)});e.exit().transition().duration(750).style("opacity","0").remove();return b.__super__.draw.call(this)};return b}(Epoch.Chart.Plot)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Chart.Pie=function(d){function b(a){this.options=null!=a?a:{};b.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,e));a=Math.max(this.width,this.height)/2;this.pie=d3.layout.pie().sort(null).value(function(a){return a.value});this.arc=d3.svg.arc().outerRadius(a-this.options.margin).innerRadius(this.options.inner);
this.svg=this.svg.append("g").attr("transform","translate("+this.width/2+", "+this.height/2+")")}var e;h(b,d);e={margin:10,inner:0};b.prototype.draw=function(){var a,c=this;a=this.svg.selectAll(".arc").data(this.pie(this.data),function(a){return a.data.label});a.enter().append("g").attr("class",function(a){return"arc pie "+a.data.className});a.select("path").attr("d",this.arc);a.select("text").attr("transform",function(a){return"translate("+c.arc.centroid(a)+")"}).text(function(a){return a.data.label});
a.append("path").attr("d",this.arc).each(function(a){return this._current=a});a.append("text").attr("transform",function(a){return"translate("+c.arc.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.label});return a.exit().remove()};return b}(Epoch.Chart.SVG)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Chart.Scatter=function(d){function b(a){this.options=null!=a?a:{};b.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,e))}var e;h(b,d);e={radius:3.5,axes:["top","bottom","left","right"]};b.prototype.draw=function(){var a,c,g,e;b.__super__.draw.call(this);a=[this.x(),
this.y()];g=a[0];e=a[1];c=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});c.enter().append("g").attr("class",function(a){return a.className});a=c.selectAll(".dot").data(function(a){return a.values});a.transition().duration(500).attr("cx",function(a){return g(a.x)}).attr("cy",function(a){return e(a.y)});a.enter().append("circle").attr("class","dot").attr("r",this.options.radius).attr("cx",function(a){return g(a.x)}).attr("cy",function(a){return e(a.y)});a.exit().transition().duration(750).style("opacity",
0).remove();return c.exit().transition().duration(750).style("opacity",0).remove()};return b}(Epoch.Chart.Plot)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Time.Plot=function(d){function b(a){var c,g,d,f,h=this;this.options=a;a=Epoch.Util.copy(this.options.margins)||{};b.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,e));this._queueSize=this.options.queueSize;this._queue=[];this.margins={};f=["top","right","bottom","left"];
g=0;for(d=f.length;g<d;g++)c=f[g],this.margins[c]=this.options.margins[c],null!=a[c]||this.hasAxis(c)||(this.margins[c]=6);this.svg=d3.select(this.el.get(0)).insert("svg",":first-child").attr("width",this.width).attr("height",this.height);"absolute"!==this.el.css("position")&&"relative"!==this.el.css("position")&&this.el.css("position","relative");this.canvas.attr("width",this.innerWidth());this.canvas.attr("height",this.innerHeight()+this.margins.bottom);this.canvas.css({position:"absolute",top:""+
this.margins.top+"px",left:""+this.margins.left+"px","z-index":"-1"});this.animation={interval:null,active:!1,delta:-(this.w()/this.options.fps),frame:0,duration:this.options.fps};this._prepareTimeAxes();this._prepareRangeAxes();this.animationCallback=function(){return h._animate()}}var e;h(b,d);e={fps:24,historySize:120,windowSize:40,queueSize:10,margins:{top:25,right:50,bottom:25,left:50},axes:["bottom"],ticks:{time:15,left:5,right:5},tickFormats:{top:Epoch.Formats.seconds,bottom:Epoch.Formats.seconds,
left:Epoch.Formats.si,right:Epoch.Formats.si}};b.prototype.setData=function(a){var c,b,e,d,f;this.data=[];f=[];for(e in a)d=a[e],b=Epoch.Util.copy(d),c=Math.max(0,d.values.length-this.options.historySize),b.values=d.values.slice(c),c=["layer"],c.push("category"+((e|0)+1)),null!=d.label&&c.push(Epoch.Util.dasherize(d.label)),b.className=c.join(" "),f.push(this.data.push(b));return f};b.prototype._offsetX=function(){return 0};b.prototype._prepareTimeAxes=function(){var a,c,b,d,e;this.hasAxis("bottom")&&
(a=this.bottomAxis=this.svg.append("g").attr("class","x axis bottom canvas").attr("transform","translate("+(this.margins.left-1)+", "+(this.innerHeight()+this.margins.top)+")"),a.append("path").attr("class","domain").attr("d","M0,0H"+(this.innerWidth()+1)));this.hasAxis("top")&&(a=this.topAxis=this.svg.append("g").attr("class","x axis top canvas").attr("transform","translate("+(this.margins.left-1)+", "+this.margins.top+")"),a.append("path").attr("class","domain").attr("d","M0,0H"+(this.innerWidth()+
1)));d=this.options.ticks.time;this._ticks=[];this._tickTimer=d;e=this.data;c=0;for(b=e.length;c<b;c++)if(a=e[c],null!=a.values&&0<a.values.length){b=[this.options.windowSize-1,a.values.length-1];c=b[0];for(b=b[1];0<=c&&0<=b;)this._pushTick(c,a.values[b].time,!1,!0),c-=d,b-=d;break}return[]};b.prototype._prepareRangeAxes=function(){this.hasAxis("left")&&this.svg.append("g").attr("class","y axis left").attr("transform","translate("+(this.margins.left-1)+", "+this.margins.top+")").call(this._leftAxis());
if(this.hasAxis("right"))return this.svg.append("g").attr("class","y axis right").attr("transform","translate("+(this.width-this.margins.right)+", "+this.margins.top+")").call(this._rightAxis())};b.prototype._leftAxis=function(){return d3.svg.axis().scale(this.y()).orient("left").ticks(this.options.ticks.left).tickFormat(this.options.tickFormats.left)};b.prototype._rightAxis=function(){return d3.svg.axis().scale(this.y()).orient("right").ticks(this.options.ticks.right).tickFormat(this.options.tickFormats.right)};
b.prototype.hasAxis=function(a){return-1<this.options.axes.indexOf(a)};b.prototype.innerWidth=function(){return this.width-(this.margins.left+this.margins.right)};b.prototype.innerHeight=function(){return this.height-(this.margins.top+this.margins.bottom)};b.prototype._prepareEntry=function(a){return a};b.prototype._startTransition=function(){if(!0!==this.animation.active&&0!==this._queue.length)return this._shift(),this.animation.active=!0,this.animation.interval=setInterval(this.animationCallback,
1E3/this.options.fps)};b.prototype._stopTransition=function(){var a,c,b,d;if(this.inTransition()){d=this.data;c=0;for(b=d.length;c<b;c++)a=d[c],a.values.length>this.options.windowSize+1&&a.values.shift();c=[this._ticks[0],this._ticks[this._ticks.length-1]];a=c[0];c=c[1];null!=c&&c.enter&&(c.enter=!1,c.opacity=1);null!=a&&a.exit&&this._shiftTick();this.animation.frame=0;if(0<this._queue.length)return this._shift();this.animation.active=!1;return clearInterval(this.animation.interval)}};b.prototype.inTransition=
function(){return this.animation.active};b.prototype.push=function(a){this._queue.length>this._queueSize&&this._queue.splice(this._queueSize,this._queue.length-this._queueSize);if(this._queue.length===this._queueSize)return!1;this._queue.push(this._prepareEntry(a));if(!this.inTransition())return this._startTransition()};b.prototype._shift=function(){var a,c,b,d;a=this._queue.shift();d=this.data;for(c in d)b=d[c],b.values.push(a[c]);this._updateTicks(a[0].time);this.hasAxis("left")&&this.svg.selectAll(".y.axis.left").transition().duration(500).ease("linear").call(this._leftAxis());
if(this.hasAxis("right"))return this.svg.selectAll(".y.axis.right").transition().duration(500).ease("linear").call(this._rightAxis())};b.prototype._animate=function(){if(this.inTransition())return++this.animation.frame===this.animation.duration&&this._stopTransition(),this.draw(this.animation.frame*this.animation.delta),this._updateTimeAxes()};b.prototype.y=function(){return d3.scale.linear().domain(this.extent(function(a){return a.y})).range([this.innerHeight(),0])};b.prototype.w=function(){return this.innerWidth()/
this.options.windowSize};b.prototype._updateTicks=function(a){if(this.hasAxis("top")||this.hasAxis("bottom"))if(++this._tickTimer%this.options.ticks.time||this._pushTick(this.options.windowSize,a,!0),!(0<=this._ticks[0].x-this.w()))return this._ticks[0].exit=!0};b.prototype._pushTick=function(a,c,b,d){null==b&&(b=!1);null==d&&(d=!1);if(this.hasAxis("top")||this.hasAxis("bottom"))return c={time:c,x:a*this.w()+this._offsetX(),opacity:b?0:1,enter:b?!0:!1,exit:!1},this.hasAxis("bottom")&&(a=this.bottomAxis.append("g").attr("class",
"tick major").attr("transform","translate("+(c.x+1)+",0)").style("opacity",c.opacity),a.append("line").attr("y2",6),a.append("text").attr("text-anchor","middle").attr("dy",19).text(this.options.tickFormats.bottom(c.time)),c.bottomEl=$(a[0])),this.hasAxis("top")&&(a=this.topAxis.append("g").attr("class","tick major").attr("transform","translate("+(c.x+1)+",0)").style("opacity",c.opacity),a.append("line").attr("y2",-6),a.append("text").attr("text-anchor","middle").attr("dy",-10).text(this.options.tickFormats.top(c.time)),
c.topEl=$(a[0])),d?this._ticks.unshift(c):this._ticks.push(c),c};b.prototype._shiftTick=function(){var a;if(0<this._ticks.length&&(a=this._ticks.shift(),null!=a.topEl&&a.topEl.remove(),null!=a.bottomEl))return a.bottomEl.remove()};b.prototype._updateTimeAxes=function(){var a,c,b,d,e,f,h;if(this.hasAxis("top")||this.hasAxis("bottom")){a=[this.animation.delta,1/this.options.fps];c=a[0];a=a[1];f=this._ticks;h=[];d=0;for(e=f.length;d<e;d++)b=f[d],b.x+=c,this.hasAxis("bottom")&&b.bottomEl.attr("transform",
"translate("+(b.x+1)+",0)"),this.hasAxis("top")&&b.topEl.attr("transform","translate("+(b.x+1)+",0)"),b.enter?b.opacity+=a:b.exit&&(b.opacity-=a),b.enter||b.exit?(this.hasAxis("bottom")&&b.bottomEl.css("opacity",b.opacity),this.hasAxis("top")?h.push(b.topEl.css("opacity",b.opacity)):h.push(void 0)):h.push(void 0);return h}};b.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height)};b.prototype.draw=function(a){};return b}(Epoch.Chart.Canvas);Epoch.Time.Stack=function(d){function b(){return b.__super__.constructor.apply(this,
arguments)}h(b,d);b.prototype._prepareEntry=function(b){var a,c,d,f;d=c=0;for(f=b.length;d<f;d++)a=b[d],a.y0=c,c+=a.y;return b};b.prototype.setData=function(d){var a,c,g,f,h;b.__super__.setData.call(this,d);h=[];a=d=0;for(f=this.data[0].values.length;0<=f?d<f:d>f;a=0<=f?++d:--d)g=0,h.push(function(){var b,d,e,f;e=this.data;f=[];b=0;for(d=e.length;b<d;b++)c=e[b],c.values[a].y0=g,f.push(g+=c.values[a].y);return f}.call(this));return h};b.prototype.extent=function(){var b,a,c,d,f,h,s,m;b=f=c=0;for(s=
this.data[0].values.length;0<=s?f<s:f>s;b=0<=s?++f:--f){a=h=d=0;for(m=this.data.length;0<=m?h<m:h>m;a=0<=m?++h:--h)d+=this.data[a].values[b].y;d>c&&(c=d)}return[0,c]};return b}(Epoch.Time.Plot)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Time.Area=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}h(b,d);b.prototype.setStyles=function(b){b=null!=b.className?this.getStyles("g."+b.className.replace(/\s/g,".")+" path.area"):this.getStyles("g path.area");this.ctx.fillStyle=b.fill;null!=b.stroke&&(this.ctx.strokeStyle=
b.stroke);if(null!=b["stroke-width"])return this.ctx.lineWidth=b["stroke-width"].replace("px","")};b.prototype.draw=function(b){var a,c,d,f,h,s,m,k,p,t;null==b&&(b=0);this.clear();s=[this.y(),this.w()];m=s[0];s=s[1];t=[];for(c=k=p=this.data.length-1;0>=p?0>=k:0<=k;c=0>=p?++k:--k){f=this.data[c];this.setStyles(f);this.ctx.beginPath();h=[this.options.windowSize,f.values.length,this.inTransition()];c=h[0];d=h[1];for(h=h[2];-2<=--c&&0<=--d;)a=f.values[d],a=[(c+1)*s+b,m(a.y+a.y0)],h&&(a[0]+=s),c===this.options.windowSize-
1?this.ctx.moveTo.apply(this.ctx,a):this.ctx.lineTo.apply(this.ctx,a);c=h?(c+3)*s+b:(c+2)*s+b;this.ctx.lineTo(c,this.innerHeight());this.ctx.lineTo(this.width+s+b,this.innerHeight());this.ctx.closePath();t.push(this.ctx.fill())}return t};return b}(Epoch.Time.Stack)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Time.Bar=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}h(b,d);b.prototype._offsetX=function(){return 0.5*this.w()};b.prototype.setStyles=function(b){b=this.getStyles("rect.bar."+b.replace(/\s/g,"."));this.ctx.fillStyle=b.fill;this.ctx.strokeStyle=b.stroke;if(null!=
b["stroke-width"])return this.ctx.lineWidth=b["stroke-width"].replace("px","")};b.prototype.draw=function(b){var a,c,d,f,h,s,m,k,p,t,n,l,x,y,v,q,r;null==b&&(b=0);this.clear();x=[this.y(),this.w()];l=x[0];n=x[1];v=this.data;r=[];x=0;for(y=v.length;x<y;x++)p=v[x],0<p.values.length&&(this.setStyles(p.className),q=[this.options.windowSize,p.values.length,this.inTransition()],s=q[0],k=q[1],m=(t=q[2])?-1:0,r.push(function(){var q,r;for(r=[];--s>=m&&0<=--k;)c=p.values[k],q=[s*n+b,c.y,c.y0],d=q[0],f=q[1],
h=q[2],t&&(d+=n),a=[d+1,l(f+h),n-2,this.innerHeight()-l(f)+0.5],this.ctx.fillRect.apply(this.ctx,a),r.push(this.ctx.strokeRect.apply(this.ctx,a));return r}.call(this)));return r};return b}(Epoch.Time.Stack)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Time.Gauge=function(d){function b(a){var c=this;this.options=null!=a?a:{};b.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,e));this.value=this.options.value||0;"absolute"!==this.el.css("position")&&"relative"!==this.el.css("position")&&this.el.css("position","relative");
this.svg=d3.select(this.el.get(0)).insert("svg",":first-child").attr("width",this.width).attr("height",this.height).attr("class","gauge-labels");$(this.svg[0]).css({position:"absolute","z-index":"1"});this.svg.append("g").attr("transform","translate("+this.centerX()+", "+this.textY()+")").append("text").attr("class","value").text(this.options.format(this.value));this.animation={interval:null,active:!1,delta:0,target:0};this._animate=function(){Math.abs(c.animation.target-c.value)<Math.abs(c.animation.delta)?
(c.value=c.animation.target,clearInterval(c.animation.interval),c.animation.active=!1):c.value+=c.animation.delta;c.svg.select("text.value").text(c.options.format(c.value));return c.draw()}}var e;h(b,d);e={domain:[0,1],ticks:10,tickSize:5,tickOffset:5,fps:34,format:Epoch.Formats.percent};b.prototype.update=function(a){this.animation.target=a;this.animation.delta=(a-this.value)/this.options.fps;if(!this.animation.active)return this.animation.interval=setInterval(this._animate,1E3/this.options.fps)};
b.prototype.radius=function(){return this.height/1.58};b.prototype.centerX=function(){return this.width/2};b.prototype.centerY=function(){return 0.68*this.height};b.prototype.textY=function(){return 0.48*this.height};b.prototype.getAngle=function(a){return a/this.options.domain[1]*(Math.PI+2*Math.PI/8)-Math.PI/2-Math.PI/8};b.prototype.setStyles=function(a){a=this.getStyles(a);this.ctx.fillStyle=a.fill;this.ctx.strokeStyle=a.stroke;if(null!=a["stroke-width"])return this.ctx.lineWidth=a["stroke-width"].replace("px",
"")};b.prototype.draw=function(){var a,b,d,e,f,h,m,k,p,t,n,l;f=[this.centerX(),this.centerY(),this.radius()];d=f[0];e=f[1];f=f[2];m=[this.options.tickOffset,this.options.tickSize];k=m[0];p=m[1];this.ctx.clearRect(0,0,this.width,this.height);m=d3.scale.linear().domain([0,this.options.ticks]).range([-1.125*Math.PI,Math.PI/8]);this.setStyles(".epoch .gauge .tick");this.ctx.beginPath();a=n=0;for(l=this.options.ticks;0<=l?n<=l:n>=l;a=0<=l?++n:--n)a=m(a),a=[Math.cos(a),Math.sin(a)],b=a[0],h=a[1],a=b*(f-
k)+d,t=h*(f-k)+e,b=b*(f-k-p)+d,h=h*(f-k-p)+e,this.ctx.moveTo(a,t),this.ctx.lineTo(b,h);this.ctx.stroke();this.setStyles(".epoch .gauge .arc.outer");this.ctx.beginPath();this.ctx.arc(d,e,f,-1.125*Math.PI,0.125*Math.PI,!1);this.ctx.stroke();this.setStyles(".epoch .gauge .arc.inner");this.ctx.beginPath();this.ctx.arc(d,e,f-10,-1.125*Math.PI,0.125*Math.PI,!1);this.ctx.stroke();return this.drawNeedle()};b.prototype.drawNeedle=function(){var a,b,d;d=[this.centerX(),this.centerY(),this.radius()];a=d[0];
b=d[1];d=d[2];this.setStyles(".epoch .gauge .needle");this.ctx.beginPath();this.ctx.save();this.ctx.translate(a,b);this.ctx.rotate(this.getAngle(this.value));this.ctx.moveTo(4,0);this.ctx.lineTo(-4,0);this.ctx.lineTo(-1,19-d);this.ctx.lineTo(1,19-d);this.ctx.fill();this.setStyles(".epoch .gauge .needle-base");this.ctx.beginPath();this.ctx.arc(0,0,this.width/25,0,2*Math.PI);this.ctx.fill();return this.ctx.restore()};return b}(Epoch.Chart.Canvas)}).call(this);
(function(){var f={}.hasOwnProperty,h=function(d,b){function e(){this.constructor=d}for(var a in b)f.call(b,a)&&(d[a]=b[a]);e.prototype=b.prototype;d.prototype=new e;d.__super__=b.prototype;return d};Epoch.Time.Line=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}h(b,d);b.prototype.setStyles=function(b){b=this.getStyles("g."+b.replace(/\s/g,".")+" path.line");this.ctx.fillStyle=b.fill;this.ctx.strokeStyle=b.stroke;return this.ctx.lineWidth=b["stroke-width"].replace("px",
"")};b.prototype.draw=function(b){var a,c,d,f,h,s,m,k,p,t,n,l;null==b&&(b=0);this.clear();c=[this.y(),this.w()];k=c[0];m=c[1];n=this.data;l=[];p=0;for(t=n.length;p<t;p++)if(h=n[p],0<h.values.length){this.setStyles(h.className);this.ctx.beginPath();d=[this.options.windowSize,h.values.length,this.inTransition()];c=d[0];f=d[1];for(d=(s=d[2])?-2:0;--c>=d&&0<=--f;)a=h.values[f],a=[(c+1)*m+b,k(a.y)],s&&(a[0]+=m),c===this.options.windowSize-1?this.ctx.moveTo.apply(this.ctx,a):this.ctx.lineTo.apply(this.ctx,
a);l.push(this.ctx.stroke())}return l};return b}(Epoch.Time.Plot)}).call(this);(function(){Epoch._typeMap={area:Epoch.Chart.Area,bar:Epoch.Chart.Bar,line:Epoch.Chart.Line,pie:Epoch.Chart.Pie,scatter:Epoch.Chart.Scatter,"time.area":Epoch.Time.Area,"time.bar":Epoch.Time.Bar,"time.line":Epoch.Time.Line,"time.gauge":Epoch.Time.Gauge}}).call(this);
(function(){jQuery.fn.epoch=function(f){var h;f.el=this;if(null==(h=this.data("epoch-chart"))){h=Epoch._typeMap[f.type];if(null==h)throw"Epoch Error: Unknown chart type '"+f.type+"'";this.data("epoch-chart",h=new h(f));h.draw()}return h}}).call(this);
