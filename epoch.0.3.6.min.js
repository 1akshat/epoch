(function(l){var k,f=/[-+,> ]/;l([],k=function(c,d){function a(d){function p(){s&&(t&&s!=t)&&(t==d&&(v||(v=f.test(w)&&c.createDocumentFragment()))||t).insertBefore(s,q||null)}for(var v,n,q,t,s,k=arguments,l=k[0],z=0;z<k.length;z++){var w=k[z];if("object"==typeof w){n=!1;if(w instanceof Array){s=c.createDocumentFragment();for(var y=0;y<w.length;y++)s.appendChild(a(w[y]));w=s}if(w.nodeType)s=w,p(),t=w,q=0;else for(y in w)s[y]=w[y]}else if(n)n=!1,s.appendChild(c.createTextNode(w));else{1>z&&(d=null);
n=!0;if(l=w.replace(e,function(e,f,v,n,l,y){f&&(p(),"-"==f||"+"==f?(t=(q=s||t).parentNode,s=null,"+"==f&&(q=q.nextSibling)):("<"==f?t=s=(s||t).parentNode:(","==f?t=d:s&&(t=s),s=null),q=0),s&&(t=s));if((e=!v&&n)||!s&&(v||l))"$"==e?(e=k[++z],t.appendChild(c.createTextNode(e))):(e=e||a.defaultTag,(f=u&&k[z+1]&&k[z+1].name)&&(e="<"+e+' name="'+f+'">'),s=m&&~(h=e.indexOf("|"))?c.createElementNS(m[e.slice(0,h)],e.slice(h+1)):c.createElement(e));if(v)if("$"==n&&(n=k[++z]),"#"==v)s.id=n;else if(f=(e=s.className)&&
(" "+e+" ").replace(" "+n+" "," "),"."==v)s.className=e?(f+n).substring(1):n;else if("!"==w){var B;u?a("div",s,"<").innerHTML="":(B=s.parentNode)&&B.removeChild(s)}else f=f.substring(1,f.length-1),f!=e&&(s.className=f);l&&("$"==y&&(y=k[++z]),"style"==l?s.style.cssText=y:(v="!"==l.charAt(0)?(l=l.substring(1))&&"removeAttribute":"setAttribute",y=""===y?l:y,m&&~(h=l.indexOf("|"))?s[v+"NS"](m[l.slice(0,h)],l.slice(h+1),y):s[v](l,y)));return""}))throw new SyntaxError("Unexpected char "+l+" in "+w);p();
t=l=s||t}}d&&v&&d.appendChild(v);return l}f=d||f;var e=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,h,m=!1;c=c||document;var u="object"==typeof c.createElement;a.addNamespace=function(e,a){c.createElementNS?(m||(m={}))[e]=a:c.namespaces.add(e,a)};a.defaultTag="div";a.forDocument=k;return a})})(function(l,k,f){f=f||k;"function"===typeof define?define([],function(){return f()}):"undefined"==typeof window?require("./node-html")(module,f):put=f()});
(function(){var l,k,f,c={}.hasOwnProperty,d=function(a,e){function h(){this.constructor=a}for(var m in e)c.call(e,m)&&(a[m]=e[m]);h.prototype=e.prototype;a.prototype=new h;a.__super__=e.prototype;return a};null==window.Epoch&&(window.Epoch={});null==(f=window.Epoch).Chart&&(f.Chart={});null==(f=window.Epoch).Time&&(f.Time={});null==(f=window.Epoch).Util&&(f.Util={});null==(f=window.Epoch).Formats&&(f.Formats={});Epoch.isArray=function(a){return"array"===$.type(a)};Epoch.isObject=function(a){return"object"===
$.type(a)};Epoch.isString=function(a){return"string"===$.type(a)};Epoch.isFunction=function(a){return"function"===$.type(a)};Epoch.warn=function(a){return(console.warn||console.log)("Epoch Warning: "+a)};Epoch.exception=function(a){throw"Epoch Error: "+a;};Epoch.Util.copy=function(a){var e,h,m;if(null==a)return null;e={};for(h in a)m=a[h],e[h]=m;return e};Epoch.Util.defaults=function(a,e){var h,m;m=Epoch.Util.copy(a);for(h in e)null!=a[h]&&null!=e[h]?!Epoch.isArray(a[h])&&Epoch.isObject(a[h])&&Epoch.isObject(e[h])?
m[h]=Epoch.Util.defaults(a[h],e[h]):m[h]=a[h]:m[h]=null!=a[h]?a[h]:e[h];return m};Epoch.Util.formatSI=function(a,e,h){var m,u,c,d;null==e&&(e=1);null==h&&(h=!1);if(1E3>a){if((a|0)!==a||h)a=a.toFixed(e);return a}d="KMGTPEZY".split("");for(u in d)if(c=d[u],m=Math.pow(10,3*((u|0)+1)),a>=m&&a<Math.pow(10,3*((u|0)+2))){a/=m;if((a|0)!==a||h)a=a.toFixed(e);return""+a+" "+c}};Epoch.Util.formatBytes=function(a,e,h){var m,u,c,d;null==e&&(e=1);null==h&&(h=!1);if(1024>a)return""+a+" B";d="KB MB GB TB PB EB ZB YB".split(" ");
for(u in d)if(c=d[u],m=Math.pow(1024,(u|0)+1),a>=m&&a<Math.pow(1024,(u|0)+2)){a/=m;if((a|0)!==a||h)a=a.toFixed(e);return""+a+" "+c}};Epoch.Util.dasherize=function(a){return a.replace("\n","").replace(/\s+/,"-").toLowerCase()};Epoch.Util.domain=function(a,e){var h,m,u,c,d,f,n,q;null==e&&(e="x");u={};c=0;for(f=a.length;c<f;c++)for(h=a[c],q=h.values,d=0,n=q.length;d<n;d++)h=q[d],u[h[e]]=!0;c=[];for(m in u)c.push(m);return c};Epoch.toRGBA=function(a,e){var h,m;if(a.match(/^rgba\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)/))h=
"rgba("+r+","+g+","+b+","+e+")";else if(m=d3.rgb(a))h="rgba("+m.r+","+m.g+","+m.b+","+e+")";return h};Epoch.Formats.regular=function(a){return a};Epoch.Formats.si=function(a){return Epoch.Util.formatSI(a)};Epoch.Formats.percent=function(a){return(100*a).toFixed(1)+"%"};Epoch.Formats.seconds=function(a){return k(new Date(1E3*a))};k=d3.time.format("%I:%M:%S %p");Epoch.Formats.bytes=function(a){return Epoch.Util.formatBytes(a)};Epoch.Events=function(){function a(){this._events={}}a.prototype.on=function(e,
a){var m;if(null!=a)return null==(m=this._events)[e]&&(m[e]=[]),this._events[e].push(a)};a.prototype.off=function(e,a){var m,u;if(Epoch.isObject(this._events[e])){if(null==a)return delete this._events[e];for(u=[];0<=(m=this._events[e].indexOf(a));)u.push(this._events[e].splice(m,1));return u}};a.prototype.trigger=function(e){var a,m,u,c,d,f,n,q;if(null!=this._events[e]){a=function(){var e,a,h;h=[];c=e=1;for(a=arguments.length;1<=a?e<a:e>a;c=1<=a?++e:--e)h.push(arguments[c]);return h}.apply(this,arguments);
n=this._events[e];q=[];d=0;for(f=n.length;d<f;d++)m=n[d],u=null,Epoch.isString(m)?u=this[m]:Epoch.isFunction(m)&&(u=m),null==u&&Epoch.exception("Callback for event '"+e+"' is not a function or reference to a method."),q.push(u.apply(this,a));return q}};return a}();Epoch.Chart.Base=function(a){function e(a){this.options=a;e.__super__.constructor.call(this);this.setData(this.options.data||[]);null!=this.options.el&&(this.el=$(this.options.el));this.width=this.options.width;this.height=this.options.height;
null!=this.el?(null==this.width&&(this.width=$(this.el).width()),null==this.height&&(this.height=$(this.el).height())):(null==this.width&&(this.width=h.dimensions.width),null==this.height&&(this.height=h.dimensions.height))}var h;d(e,a);h={width:320,height:240};e.prototype.setData=function(e){var a,h,c,d,f;a=1;d=0;for(f=e.length;d<f;d++)c=e[d],h=["layer"],h.push("category"+a),null!=c.label&&h.push(Epoch.Util.dasherize(c.label)),c.className=h.join(" "),a++;return this.data=e};e.prototype.update=function(e,
a){null==a&&(a=!0);this.setData(e);if(a)return this.draw()};e.prototype.draw=function(){};e.prototype.extent=function(e){return[d3.min(this.data,function(a){return d3.min(a.values,e)}),d3.max(this.data,function(a){return d3.max(a.values,e)})]};return e}(Epoch.Events);Epoch.Chart.SVG=function(a){function e(a){this.options=null!=a?a:{};e.__super__.constructor.call(this,this.options);this.svg=null!=this.el?d3.select(this.el.get(0)).append("svg"):d3.select(document.createElement("svg"));this.svg.attr({xmlns:"http://www.w3.org/2000/svg",
width:this.width,height:this.height})}d(e,a);return e}(Epoch.Chart.Base);Epoch.Chart.Canvas=function(a){function e(a){this.options=null!=a?a:{};e.__super__.constructor.call(this,this.options);this.canvas=$("<canvas></canvas>");this.canvas.attr("width",this.width).attr("height",this.height);null!=this.el&&this.el.append(this.canvas);this.ctx=this.canvas.get(0).getContext("2d")}d(e,a);e.prototype.getStyles=function(a){return l.getStyles(a,this.el)};return e}(Epoch.Chart.Base);l=function(){function a(){}
a.cache={};a.styleList=["fill","stroke","stroke-width"];a.container=null;a.load=function(){$("body").append('<div id="_canvas_css_reference"></div>');return a.container=$("#_canvas_css_reference","body")};a.containerId=function(a){return""+a.attr("id")+"."+a.attr("class")};a.getStyles=function(e,h){var m,c,d,p,f,n,q,t;c=""+a.containerId(h)+"__"+e;m=a.cache[c];if(null!=m)return m;m=$(h).clone().html("<svg></svg>");m.removeAttr("style");a.container.append(m);q=$("svg",m);p=e.split(/\s+/);for(f=n=put(p.shift());p.length;)d=
put(p.shift()),f.appendChild(d),f=d;q.html(n);p=$(e,q);f={};t=a.styleList;n=0;for(q=t.length;n<q;n++)d=t[n],f[d]=p.css(d);a.cache[c]=f;$(m,a.container).remove();return f};return a}();$(l.load)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Chart.Plot=function(f){function c(a){var e,h,m,u;this.options=null!=a?a:{};a=Epoch.Util.copy(this.options.margins)||{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,d));this.margins={};u=["top","right","bottom","left"];h=0;for(m=u.length;h<m;h++)e=u[h],this.margins[e]=
this.options.margins[e],null!=a[e]||this.hasAxis(e)||(this.margins[e]=6);this.svg=this.svg.append("g").attr("transform","translate("+this.margins.left+", "+this.margins.top+")")}var d;k(c,f);d={margins:{top:25,right:50,bottom:25,left:50},axes:["left","bottom"],ticks:{top:14,bottom:14,left:5,right:5},tickFormats:{top:Epoch.Formats.regular,bottom:Epoch.Formats.regular,left:Epoch.Formats.si,right:Epoch.Formats.si}};c.prototype.setTickFormat=function(a,e){return this.options.tickFormats[a]=e};c.prototype.hasAxis=
function(a){return-1<this.options.axes.indexOf(a)};c.prototype.innerWidth=function(){return this.width-(this.margins.left+this.margins.right)};c.prototype.innerHeight=function(){return this.height-(this.margins.top+this.margins.bottom)};c.prototype.x=function(){return d3.scale.linear().domain(this.extent(function(a){return a.x})).range([0,this.innerWidth()])};c.prototype.y=function(){return d3.scale.linear().domain(this.extent(function(a){return a.y})).range([this.innerHeight(),0])};c.prototype.bottomAxis=
function(){return d3.svg.axis().scale(this.x()).orient("bottom").ticks(this.options.ticks.bottom).tickFormat(this.options.tickFormats.bottom)};c.prototype.topAxis=function(){return d3.svg.axis().scale(this.x()).orient("top").ticks(this.options.ticks.top).tickFormat(this.options.tickFormats.top)};c.prototype.leftAxis=function(){return d3.svg.axis().scale(this.y()).orient("left").ticks(this.options.ticks.left).tickFormat(this.options.tickFormats.left)};c.prototype.rightAxis=function(){return d3.svg.axis().scale(this.y()).orient("right").ticks(this.options.ticks.right).tickFormat(this.options.tickFormats.right)};
c.prototype.draw=function(){c.__super__.draw.call(this);return this._axesDrawn?this._redrawAxes():this._drawAxes()};c.prototype._redrawAxes=function(){this.hasAxis("bottom")&&this.svg.selectAll(".x.axis.bottom").transition().duration(500).ease("linear").call(this.bottomAxis());this.hasAxis("top")&&this.svg.selectAll(".x.axis.top").transition().duration(500).ease("linear").call(this.topAxis());this.hasAxis("left")&&this.svg.selectAll(".y.axis.left").transition().duration(500).ease("linear").call(this.leftAxis());
if(this.hasAxis("right"))return this.svg.selectAll(".y.axis.right").transition().duration(500).ease("linear").call(this.rightAxis())};c.prototype._drawAxes=function(){this.hasAxis("bottom")&&this.svg.append("g").attr("class","x axis bottom").attr("transform","translate(0, "+this.innerHeight()+")").call(this.bottomAxis());this.hasAxis("top")&&this.svg.append("g").attr("class","x axis top").call(this.topAxis());this.hasAxis("left")&&this.svg.append("g").attr("class","y axis left").call(this.leftAxis());
this.hasAxis("right")&&this.svg.append("g").attr("class","y axis right").attr("transform","translate("+this.innerWidth()+", 0)").call(this.rightAxis());return this._axesDrawn=!0};return c}(Epoch.Chart.SVG)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Chart.Area=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype.y=function(){var a,e,h,m,c,d,f;a=[];d=this.data;m=0;for(c=d.length;m<c;m++)for(e in h=d[m],f=h.values,f)h=f[e],null!=a[e]&&(a[e]+=h.y),null==a[e]&&(a[e]=h.y);return d3.scale.linear().domain([0,
d3.max(a)]).range([this.height-this.margins.top-this.margins.bottom,0])};d.prototype.draw=function(){var a,e,h,m;e=[this.x(),this.y()];h=e[0];m=e[1];a=d3.svg.area().x(function(a){return h(a.x)}).y0(function(a){return m(a.y0)}).y1(function(a){return m(a.y0+a.y)});d3.layout.stack().values(function(a){return a.values})(this.data);this.svg.selectAll(".layer").remove();e=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});e.select(".area").attr("d",function(e){return a(e.values)});
e.enter().append("g").attr("class",function(a){return a.className});e.append("path").attr("class","area").attr("d",function(e){return a(e.values)});return d.__super__.draw.call(this)};return d}(Epoch.Chart.Plot)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Chart.Bar=function(f){function c(a){this.options=null!=a?a:{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,d))}var d;k(c,f);d={style:"grouped"};c.prototype.x=function(){return d3.scale.ordinal().domain(Epoch.Util.domain(this.data)).rangeRoundBands([0,this.innerWidth()],
0.1)};c.prototype.x1=function(a){var e;return d3.scale.ordinal().domain(function(){var a,m,c,d;c=this.data;d=[];a=0;for(m=c.length;a<m;a++)e=c[a],d.push(e.label);return d}.call(this)).rangeRoundBands([0,a.rangeBand()],0.08)};c.prototype.y=function(){var a;a=this.extent(function(a){return a.y});a[0]=Math.min(0,a[0]);return d3.scale.linear().domain(a).range([this.height-this.margins.top-this.margins.bottom,0])};c.prototype._remapData=function(){var a,e,h,m,c,d,f,v,n,q,t,s;c={};t=this.data;d=0;for(v=
t.length;d<v;d++)for(m=t[d],a="bar "+m.className.replace(/\s*layer\s*/,""),s=m.values,f=0,n=s.length;f<n;f++)e=s[f],null==c[q=e.x]&&(c[q]=[]),c[e.x].push({label:m.label,y:e.y,className:a});e=[];for(h in c)a=c[h],e.push({group:h,values:a});return e};c.prototype.draw=function(){var a,e,h,m,d,f;a=[this.x(),this.y()];m=a[0];f=a[1];d=this.x1(m);e=this.height-this.margins.top-this.margins.bottom;a=this._remapData();a=this.svg.selectAll(".layer").data(a,function(a){return a.group});a.transition().duration(750).attr("transform",
function(a){return"translate("+m(a.group)+", 0)"});a.enter().append("g").attr("class","layer").attr("transform",function(a){return"translate("+m(a.group)+", 0)"});h=a.selectAll("rect").data(function(a){return a.values});h.transition().duration(600).attr("x",function(a){return d(a.label)}).attr("y",function(a){return f(a.y)}).attr("width",d.rangeBand()).attr("height",function(a){return e-f(a.y)});h.enter().append("rect").attr("class",function(a){return a.className}).attr("x",function(a){return d(a.label)}).attr("y",
function(a){return f(a.y)}).attr("width",d.rangeBand()).attr("height",function(a){return e-f(a.y)});h.exit().transition().duration(150).style("opacity","0").remove();a.exit().transition().duration(750).style("opacity","0").remove();return c.__super__.draw.call(this)};return c}(Epoch.Chart.Plot)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Chart.Line=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype.line=function(){var a,e,h;h=[this.x(),this.y()];a=h[0];e=h[1];return d3.svg.line().x(function(e){return a(e.x)}).y(function(a){return e(a.y)})};d.prototype.draw=function(){var a,e;e=[this.x(),
this.y(),this.line()][2];a=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});a.select(".line").transition().duration(500).attr("d",function(a){return e(a.values)});a.enter().append("g").attr("class",function(a){return a.className}).append("path").attr("class","line").attr("d",function(a){return e(a.values)});a.exit().transition().duration(750).style("opacity","0").remove();return d.__super__.draw.call(this)};return d}(Epoch.Chart.Plot)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Chart.Pie=function(f){function c(a){this.options=null!=a?a:{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,d));a=Math.max(this.width,this.height)/2;this.pie=d3.layout.pie().sort(null).value(function(a){return a.value});this.arc=d3.svg.arc().outerRadius(a-this.options.margin).innerRadius(this.options.inner);
this.svg=this.svg.append("g").attr("transform","translate("+this.width/2+", "+this.height/2+")")}var d;k(c,f);d={margin:10,inner:0};c.prototype.draw=function(){var a,e=this;a=this.svg.selectAll(".arc").data(this.pie(this.data),function(a){return a.data.label});a.enter().append("g").attr("class",function(a){return"arc pie "+a.data.className});a.select("path").attr("d",this.arc);a.select("text").attr("transform",function(a){return"translate("+e.arc.centroid(a)+")"}).text(function(a){return a.data.label});
a.append("path").attr("d",this.arc).each(function(a){return this._current=a});a.append("text").attr("transform",function(a){return"translate("+e.arc.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.label});return a.exit().remove()};return c}(Epoch.Chart.SVG)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Chart.Scatter=function(f){function c(a){this.options=null!=a?a:{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,d))}var d;k(c,f);d={radius:3.5,axes:["top","bottom","left","right"]};c.prototype.draw=function(){var a,e,h,d;c.__super__.draw.call(this);a=[this.x(),
this.y()];h=a[0];d=a[1];e=this.svg.selectAll(".layer").data(this.data,function(a){return a.label});e.enter().append("g").attr("class",function(a){return a.className});a=e.selectAll(".dot").data(function(a){return a.values});a.transition().duration(500).attr("cx",function(a){return h(a.x)}).attr("cy",function(a){return d(a.y)});a.enter().append("circle").attr("class","dot").attr("r",this.options.radius).attr("cx",function(a){return h(a.x)}).attr("cy",function(a){return d(a.y)});a.exit().transition().duration(750).style("opacity",
0).remove();return e.exit().transition().duration(750).style("opacity",0).remove()};return c}(Epoch.Chart.Plot)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Time.Plot=function(c){function d(e){var h,c,u,f,p=this;this.options=e;e=Epoch.Util.copy(this.options.margins)||{};d.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,a));this._queueSize=this.options.queueSize;this._queue=[];this.margins={};f=["top","right","bottom",
"left"];c=0;for(u=f.length;c<u;c++)h=f[c],this.margins[h]=this.options.margins[h],null!=e[h]||this.hasAxis(h)||(this.margins[h]=6);this.svg=d3.select(this.el.get(0)).insert("svg",":first-child").attr("width",this.width).attr("height",this.height);"absolute"!==this.el.css("position")&&"relative"!==this.el.css("position")&&this.el.css("position","relative");this.canvas.attr("width",this.innerWidth());this.canvas.attr("height",this.innerHeight()+this.margins.bottom);this.canvas.css({position:"absolute",
top:""+this.margins.top+"px",left:""+this.margins.left+"px","z-index":"-1"});this.animation={interval:null,active:!1,delta:-(this.w()/this.options.fps),frame:0,duration:this.options.fps};this._prepareTimeAxes();this._prepareRangeAxes();this.animationCallback=function(){return p._animate()}}var a;f(d,c);a={fps:24,historySize:120,windowSize:40,queueSize:10,margins:{top:25,right:50,bottom:25,left:50},axes:["bottom"],ticks:{time:15,left:5,right:5},tickFormats:{top:Epoch.Formats.seconds,bottom:Epoch.Formats.seconds,
left:Epoch.Formats.si,right:Epoch.Formats.si}};d.prototype.setData=function(a){var h,c,d,f,p;this.data=[];p=[];for(d in a)f=a[d],c=Epoch.Util.copy(f),h=Math.max(0,f.values.length-this.options.historySize),c.values=f.values.slice(h),h=["layer"],h.push("category"+((d|0)+1)),null!=f.label&&h.push(Epoch.Util.dasherize(f.label)),c.className=h.join(" "),p.push(this.data.push(c));return p};d.prototype._offsetX=function(){return 0};d.prototype._prepareTimeAxes=function(){var a,h,c,d,f;this.hasAxis("bottom")&&
(a=this.bottomAxis=this.svg.append("g").attr("class","x axis bottom canvas").attr("transform","translate("+(this.margins.left-1)+", "+(this.innerHeight()+this.margins.top)+")"),a.append("path").attr("class","domain").attr("d","M0,0H"+(this.innerWidth()+1)));this.hasAxis("top")&&(a=this.topAxis=this.svg.append("g").attr("class","x axis top canvas").attr("transform","translate("+(this.margins.left-1)+", "+this.margins.top+")"),a.append("path").attr("class","domain").attr("d","M0,0H"+(this.innerWidth()+
1)));d=this.options.ticks.time;this._ticks=[];this._tickTimer=d;f=this.data;h=0;for(c=f.length;h<c;h++)if(a=f[h],null!=a.values&&0<a.values.length){c=[this.options.windowSize-1,a.values.length-1];h=c[0];for(c=c[1];0<=h&&0<=c;)this._pushTick(h,a.values[c].time,!1,!0),h-=d,c-=d;break}return[]};d.prototype._prepareRangeAxes=function(){this.hasAxis("left")&&this.svg.append("g").attr("class","y axis left").attr("transform","translate("+(this.margins.left-1)+", "+this.margins.top+")").call(this.leftAxis());
if(this.hasAxis("right"))return this.svg.append("g").attr("class","y axis right").attr("transform","translate("+(this.width-this.margins.right)+", "+this.margins.top+")").call(this.rightAxis())};d.prototype.leftAxis=function(){return d3.svg.axis().scale(this.y()).orient("left").ticks(this.options.ticks.left).tickFormat(this.options.tickFormats.left)};d.prototype.rightAxis=function(){return d3.svg.axis().scale(this.y()).orient("right").ticks(this.options.ticks.right).tickFormat(this.options.tickFormats.right)};
d.prototype.hasAxis=function(a){return-1<this.options.axes.indexOf(a)};d.prototype.innerWidth=function(){return this.width-(this.margins.left+this.margins.right)};d.prototype.innerHeight=function(){return this.height-(this.margins.top+this.margins.bottom)};d.prototype._prepareEntry=function(a){return a};d.prototype._prepareLayers=function(a){return a};d.prototype._startTransition=function(){if(!0!==this.animation.active&&0!==this._queue.length)return this.trigger("transition:start"),this._shift(),
this.animation.active=!0,this.animation.interval=setInterval(this.animationCallback,1E3/this.options.fps)};d.prototype._stopTransition=function(){var a,h,c,d;if(this.inTransition()){d=this.data;h=0;for(c=d.length;h<c;h++)a=d[h],a.values.length>this.options.windowSize+1&&a.values.shift();h=[this._ticks[0],this._ticks[this._ticks.length-1]];a=h[0];h=h[1];null!=h&&h.enter&&(h.enter=!1,h.opacity=1);null!=a&&a.exit&&this._shiftTick();this.animation.frame=0;this.trigger("transition:end");if(0<this._queue.length)return this._shift();
this.animation.active=!1;return clearInterval(this.animation.interval)}};d.prototype.inTransition=function(){return this.animation.active};d.prototype.push=function(a){var h=this;a=this._prepareLayers(a);this._queue.length>this._queueSize&&this._queue.splice(this._queueSize,this._queue.length-this._queueSize);if(this._queue.length===this._queueSize)return!1;this._queue.push(a.map(function(a){return h._prepareEntry(a)}));this.trigger("push");if(!this.inTransition())return this._startTransition()};
d.prototype._shift=function(){var a,h,c,d;this.trigger("before:shift");a=this._queue.shift();d=this.data;for(h in d)c=d[h],c.values.push(a[h]);this._updateTicks(a[0].time);this.hasAxis("left")&&this.svg.selectAll(".y.axis.left").transition().duration(500).ease("linear").call(this.leftAxis());this.hasAxis("right")&&this.svg.selectAll(".y.axis.right").transition().duration(500).ease("linear").call(this.rightAxis());return this.trigger("after:shift")};d.prototype._animate=function(){if(this.inTransition())return++this.animation.frame===
this.animation.duration&&this._stopTransition(),this.draw(this.animation.frame*this.animation.delta),this._updateTimeAxes()};d.prototype.y=function(){return d3.scale.linear().domain(this.extent(function(a){return a.y})).range([this.innerHeight(),0])};d.prototype.w=function(){return this.innerWidth()/this.options.windowSize};d.prototype._updateTicks=function(a){if(this.hasAxis("top")||this.hasAxis("bottom"))if(++this._tickTimer%this.options.ticks.time||this._pushTick(this.options.windowSize,a,!0),
!(0<=this._ticks[0].x-this.w()))return this._ticks[0].exit=!0};d.prototype._pushTick=function(a,h,c,d){null==c&&(c=!1);null==d&&(d=!1);if(this.hasAxis("top")||this.hasAxis("bottom"))return h={time:h,x:a*this.w()+this._offsetX(),opacity:c?0:1,enter:c?!0:!1,exit:!1},this.hasAxis("bottom")&&(a=this.bottomAxis.append("g").attr("class","tick major").attr("transform","translate("+(h.x+1)+",0)").style("opacity",h.opacity),a.append("line").attr("y2",6),a.append("text").attr("text-anchor","middle").attr("dy",
19).text(this.options.tickFormats.bottom(h.time)),h.bottomEl=$(a[0])),this.hasAxis("top")&&(a=this.topAxis.append("g").attr("class","tick major").attr("transform","translate("+(h.x+1)+",0)").style("opacity",h.opacity),a.append("line").attr("y2",-6),a.append("text").attr("text-anchor","middle").attr("dy",-10).text(this.options.tickFormats.top(h.time)),h.topEl=$(a[0])),d?this._ticks.unshift(h):this._ticks.push(h),h};d.prototype._shiftTick=function(){var a;if(0<this._ticks.length&&(a=this._ticks.shift(),
null!=a.topEl&&a.topEl.remove(),null!=a.bottomEl))return a.bottomEl.remove()};d.prototype._updateTimeAxes=function(){var a,h,c,d,f,p,v;if(this.hasAxis("top")||this.hasAxis("bottom")){a=[this.animation.delta,1/this.options.fps];h=a[0];a=a[1];p=this._ticks;v=[];d=0;for(f=p.length;d<f;d++)c=p[d],c.x+=h,this.hasAxis("bottom")&&c.bottomEl.attr("transform","translate("+(c.x+1)+",0)"),this.hasAxis("top")&&c.topEl.attr("transform","translate("+(c.x+1)+",0)"),c.enter?c.opacity+=a:c.exit&&(c.opacity-=a),c.enter||
c.exit?(this.hasAxis("bottom")&&c.bottomEl.css("opacity",c.opacity),this.hasAxis("top")?v.push(c.topEl.css("opacity",c.opacity)):v.push(void 0)):v.push(void 0);return v}};d.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height)};d.prototype.draw=function(a){};return d}(Epoch.Chart.Canvas);Epoch.Time.Stack=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype._prepareLayers=function(a){var e,c,d,f;d=c=0;for(f=a.length;d<f;d++)e=
a[d],e.y0=c,c+=e.y;return a};d.prototype.setData=function(a){var e,c,f,u,x;d.__super__.setData.call(this,a);x=[];e=a=0;for(u=this.data[0].values.length;0<=u?a<u:a>u;e=0<=u?++a:--a)f=0,x.push(function(){var a,d,u,q;u=this.data;q=[];a=0;for(d=u.length;a<d;a++)c=u[a],c.values[e].y0=f,q.push(f+=c.values[e].y);return q}.call(this));return x};d.prototype.extent=function(){var a,e,c,d,f,x,p,v;a=f=c=0;for(p=this.data[0].values.length;0<=p?f<p:f>p;a=0<=p?++f:--f){e=x=d=0;for(v=this.data.length;0<=v?x<v:x>
v;e=0<=v?++x:--x)d+=this.data[e].values[a].y;d>c&&(c=d)}return[0,c]};return d}(Epoch.Time.Plot)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Time.Area=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype.setStyles=function(a){a=null!=a.className?this.getStyles("g."+a.className.replace(/\s/g,".")+" path.area"):this.getStyles("g path.area");this.ctx.fillStyle=a.fill;null!=a.stroke&&(this.ctx.strokeStyle=
a.stroke);if(null!=a["stroke-width"])return this.ctx.lineWidth=a["stroke-width"].replace("px","")};d.prototype.draw=function(a){var e,c,d,f,x,p,v,n,q,t;null==a&&(a=0);this.clear();p=[this.y(),this.w()];v=p[0];p=p[1];t=[];for(c=n=q=this.data.length-1;0>=q?0>=n:0<=n;c=0>=q?++n:--n){f=this.data[c];this.setStyles(f);this.ctx.beginPath();x=[this.options.windowSize,f.values.length,this.inTransition()];c=x[0];d=x[1];for(x=x[2];-2<=--c&&0<=--d;)e=f.values[d],e=[(c+1)*p+a,v(e.y+e.y0)],x&&(e[0]+=p),c===this.options.windowSize-
1?this.ctx.moveTo.apply(this.ctx,e):this.ctx.lineTo.apply(this.ctx,e);c=x?(c+3)*p+a:(c+2)*p+a;this.ctx.lineTo(c,this.innerHeight());this.ctx.lineTo(this.width+p+a,this.innerHeight());this.ctx.closePath();t.push(this.ctx.fill())}return t};return d}(Epoch.Time.Stack)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Time.Bar=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype._offsetX=function(){return 0.5*this.w()};d.prototype.setStyles=function(a){a=this.getStyles("rect.bar."+a.replace(/\s/g,"."));this.ctx.fillStyle=a.fill;this.ctx.strokeStyle=null==a.stroke||
"none"===a.stroke?"transparent":a.stroke;if(null!=a["stroke-width"])return this.ctx.lineWidth=a["stroke-width"].replace("px","")};d.prototype.draw=function(a){var e,c,d,f,x,p,v,n,q,t,s,l,k,z,w,y,C;null==a&&(a=0);this.clear();k=[this.y(),this.w()];l=k[0];s=k[1];w=this.data;C=[];k=0;for(z=w.length;k<z;k++)q=w[k],0<q.values.length&&(this.setStyles(q.className),y=[this.options.windowSize,q.values.length,this.inTransition()],p=y[0],n=y[1],v=(t=y[2])?-1:0,C.push(function(){var k,w;for(w=[];--p>=v&&0<=--n;)c=
q.values[n],k=[p*s+a,c.y,c.y0],d=k[0],f=k[1],x=k[2],t&&(d+=s),e=[d+1,l(f+x),s-2,this.innerHeight()-l(f)+0.5],this.ctx.fillRect.apply(this.ctx,e),w.push(this.ctx.strokeRect.apply(this.ctx,e));return w}.call(this)));return C};return d}(Epoch.Time.Stack)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Time.Gauge=function(f){function c(a){var e=this;this.options=null!=a?a:{};c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,d));this.value=this.options.value||0;"absolute"!==this.el.css("position")&&"relative"!==this.el.css("position")&&this.el.css("position","relative");
this.svg=d3.select(this.el.get(0)).insert("svg",":first-child").attr("width",this.width).attr("height",this.height).attr("class","gauge-labels");$(this.svg[0]).css({position:"absolute","z-index":"1"});this.svg.append("g").attr("transform","translate("+this.centerX()+", "+this.textY()+")").append("text").attr("class","value").text(this.options.format(this.value));this.animation={interval:null,active:!1,delta:0,target:0};this._animate=function(){Math.abs(e.animation.target-e.value)<Math.abs(e.animation.delta)?
(e.value=e.animation.target,clearInterval(e.animation.interval),e.animation.active=!1):e.value+=e.animation.delta;e.svg.select("text.value").text(e.options.format(e.value));return e.draw()}}var d;k(c,f);d={domain:[0,1],ticks:10,tickSize:5,tickOffset:5,fps:34,format:Epoch.Formats.percent};c.prototype.update=function(a){this.animation.target=a;this.animation.delta=(a-this.value)/this.options.fps;if(!this.animation.active)return this.animation.interval=setInterval(this._animate,1E3/this.options.fps),
this.animation.active=!0};c.prototype.push=function(a){return this.update(a)};c.prototype.radius=function(){return this.height/1.58};c.prototype.centerX=function(){return this.width/2};c.prototype.centerY=function(){return 0.68*this.height};c.prototype.textY=function(){return 0.48*this.height};c.prototype.getAngle=function(a){var e,c;c=this.options.domain;e=c[0];return(a-e)/(c[1]-e)*(Math.PI+2*Math.PI/8)-Math.PI/2-Math.PI/8};c.prototype.setStyles=function(a){a=this.getStyles(a);this.ctx.fillStyle=
a.fill;this.ctx.strokeStyle=a.stroke;if(null!=a["stroke-width"])return this.ctx.lineWidth=a["stroke-width"].replace("px","")};c.prototype.draw=function(){var a,e,c,d,f,x,p,k,n,q,l,s;f=[this.centerX(),this.centerY(),this.radius()];c=f[0];d=f[1];f=f[2];p=[this.options.tickOffset,this.options.tickSize];k=p[0];n=p[1];this.ctx.clearRect(0,0,this.width,this.height);p=d3.scale.linear().domain([0,this.options.ticks]).range([-1.125*Math.PI,Math.PI/8]);this.setStyles(".epoch .gauge .tick");this.ctx.beginPath();
a=l=0;for(s=this.options.ticks;0<=s?l<=s:l>=s;a=0<=s?++l:--l)a=p(a),a=[Math.cos(a),Math.sin(a)],e=a[0],x=a[1],a=e*(f-k)+c,q=x*(f-k)+d,e=e*(f-k-n)+c,x=x*(f-k-n)+d,this.ctx.moveTo(a,q),this.ctx.lineTo(e,x);this.ctx.stroke();this.setStyles(".epoch .gauge .arc.outer");this.ctx.beginPath();this.ctx.arc(c,d,f,-1.125*Math.PI,0.125*Math.PI,!1);this.ctx.stroke();this.setStyles(".epoch .gauge .arc.inner");this.ctx.beginPath();this.ctx.arc(c,d,f-10,-1.125*Math.PI,0.125*Math.PI,!1);this.ctx.stroke();return this.drawNeedle()};
c.prototype.drawNeedle=function(){var a,e,c;c=[this.centerX(),this.centerY(),this.radius()];a=c[0];e=c[1];c=c[2];this.setStyles(".epoch .gauge .needle");this.ctx.beginPath();this.ctx.save();this.ctx.translate(a,e);this.ctx.rotate(this.getAngle(this.value));this.ctx.moveTo(4,0);this.ctx.lineTo(-4,0);this.ctx.lineTo(-1,19-c);this.ctx.lineTo(1,19-c);this.ctx.fill();this.setStyles(".epoch .gauge .needle-base");this.ctx.beginPath();this.ctx.arc(0,0,this.width/25,0,2*Math.PI);this.ctx.fill();return this.ctx.restore()};
return c}(Epoch.Chart.Canvas)}).call(this);
(function(){var l={}.hasOwnProperty,k=function(f,c){function d(){this.constructor=f}for(var a in c)l.call(c,a)&&(f[a]=c[a]);d.prototype=c.prototype;f.prototype=new d;f.__super__=c.prototype;return f};Epoch.Time.Heatmap=function(f){function c(e){this.options=e;c.__super__.constructor.call(this,this.options=Epoch.Util.defaults(this.options,a));Epoch.isString(this.options.opacity)?(this._colorFn=d[this.options.opacity],null==this._colorFn&&Epoch.exception("Unknown coloring function provided '"+this.options.opacity+
"'")):Epoch.isFunction(this.options.opacity)?this._colorFn=this.options.opacity:Epoch.exception("Unknown type for provided coloring function.");this._setupPaintCanvas()}var d,a;k(c,f);a={buckets:10,bucketRange:[0,100],opacity:"linear",bucketPadding:2};d={root:function(a,c){return Math.pow(a/c,0.5)},linear:function(a,c){return a/c},quadratic:function(a,c){return Math.pow(a/c,2)},cubic:function(a,c){return Math.pow(a/c,3)},quartic:function(a,c){return Math.pow(a/c,4)},quintic:function(a,c){return Math.pow(a/
c,5)}};c.prototype.setData=function(a){var d,f,u,k,p=this;c.__super__.setData.call(this,a);u=this.data;k=[];d=0;for(f=u.length;d<f;d++)a=u[d],k.push(a.values=a.values.map(function(a){return p._prepareEntry(a)}));return k};c.prototype._prepareEntry=function(a){var c,d,f,k,p,l,n,q,t,s;p={time:a.time,max:0,buckets:{}};f=this.options.bucketRange;k=f[0];f=f[1];l=(f-k)/this.options.buckets;d=c=0;for(q=this.options.buckets;0<=q?c<q:c>q;d=0<=q?++c:--c)p.buckets[k+l*(d+1)]=0;t=a.histogram;for(n in t)for(a=
t[n],d=q=0,s=this.options.buckets;0<=s?q<s:q>s;d=0<=s?++q:--q)if(c=k+l*(d+1),n<c||d===this.options.buckets-1){p.buckets[c]+=a;break}k=p.buckets;for(f in k)a=k[f],p.max=Math.max(p.max,a);return p};c.prototype.y=function(){return d3.scale.linear().domain(this.options.bucketRange).range([this.innerHeight(),0])};c.prototype.h=function(){return this.innerHeight()/this.options.buckets};c.prototype._offsetX=function(){return 0.5*this.w()};c.prototype._setupPaintCanvas=function(){var a,c;this.paintWidth=
(this.options.windowSize+1)*this.w();this.paintHeight=this.height;this.paint=$("<canvas width='"+this.paintWidth+"' height='"+this.paintHeight+"'>").get(0);this.p=this.paint.getContext("2d");c=this.data[0].values.length;for(a=this.options.windowSize;0<=--c&&0<=--a;)this._paintEntry(c,a);this.on("after:shift","_paintEntry");return this.on("transition:end","_shiftPaintCanvas")};c.prototype._paintEntry=function(a,c){var d,f,k,p,l,n,q,t,s,A,B,z,w,y,C;null==a&&(a=null);null==c&&(c=null);f=[this.w(),this.h()];
z=f[0];q=f[1];null==a&&(a=this.data[0].values.length-1);null==c&&(c=this.options.windowSize);l=[];f={};B=0;A=this.data;k=0;for(t=A.length;k<t;k++){s=A[k];n=s.values[a];w=n.buckets;for(d in w)p=w[d],null==f[d]&&(f[d]=0),f[d]+=p;B+=n.max;p=this.getStyles("."+s.className.split(" ").join(".")+" rect.bucket");n.color=p.fill;l.push(n)}s=c*z;this.p.clearRect(s,0,z,this.paintHeight);t=this.options.buckets;C=[];for(d in f){p=f[d];k=this._avgLab(l,d);w=A=0;for(y=l.length;w<y;w++)n=l[w],A+=n.buckets[d]/p*B;
this.p.fillStyle=Epoch.toRGBA(k,this._colorFn(p,A));this.p.fillRect(s,(t-1)*q,z-this.options.bucketPadding,q-this.options.bucketPadding);C.push(t--)}return C};c.prototype._shiftPaintCanvas=function(){var a;a=this.p.getImageData(this.w(),0,this.paintWidth-this.w(),this.paintHeight);return this.p.putImageData(a,0,0)};c.prototype._avgLab=function(a,c){var d,f,k,l,v,n,q,t;q=[0,0,0,0];v=q[0];d=q[1];f=q[2];q=q[3];n=0;for(t=a.length;n<t;n++)k=a[n],null!=k.buckets[c]&&(q+=k.buckets[c]);for(l in a)k=a[l],
n=null!=k.buckets[c]?k.buckets[c]|0:0,n/=q,k=d3.lab(k.color),v+=n*k.l,d+=n*k.a,f+=n*k.b;return d3.lab(v,d,f).toString()};c.prototype.draw=function(a){null==a&&(a=0);this.clear();return this.ctx.drawImage(this.paint,a,0)};return c}(Epoch.Time.Plot)}).call(this);
(function(){var l,k={}.hasOwnProperty,f=function(c,d){function a(){this.constructor=c}for(var e in d)k.call(d,e)&&(c[e]=d[e]);a.prototype=d.prototype;c.prototype=new a;c.__super__=d.prototype;return c};Epoch.Time.Line=function(c){function d(){return l=d.__super__.constructor.apply(this,arguments)}f(d,c);d.prototype.setStyles=function(a){a=this.getStyles("g."+a.replace(/\s/g,".")+" path.line");this.ctx.fillStyle=a.fill;this.ctx.strokeStyle=a.stroke;return this.ctx.lineWidth=a["stroke-width"].replace("px",
"")};d.prototype.draw=function(a){var c,d,f,k,l,p,v,n,q,t,s;null==a&&(a=0);this.clear();d=[this.y(),this.w()];v=d[0];p=d[1];t=this.data;s=[];n=0;for(q=t.length;n<q;n++)if(k=t[n],0<k.values.length){this.setStyles(k.className);this.ctx.beginPath();l=[this.options.windowSize,k.values.length,this.inTransition()];d=l[0];f=l[1];for(l=l[2];-2<=--d&&0<=--f;)c=k.values[f],c=[(d+1)*p+a,v(c.y)],l&&(c[0]+=p),d===this.options.windowSize-1?this.ctx.moveTo.apply(this.ctx,c):this.ctx.lineTo.apply(this.ctx,c);s.push(this.ctx.stroke())}return s};
return d}(Epoch.Time.Plot)}).call(this);(function(){Epoch._typeMap={area:Epoch.Chart.Area,bar:Epoch.Chart.Bar,line:Epoch.Chart.Line,pie:Epoch.Chart.Pie,scatter:Epoch.Chart.Scatter,"time.area":Epoch.Time.Area,"time.bar":Epoch.Time.Bar,"time.line":Epoch.Time.Line,"time.gauge":Epoch.Time.Gauge,"time.heatmap":Epoch.Time.Heatmap}}).call(this);
(function(){jQuery.fn.epoch=function(l){var k;l.el=this;null==(k=this.data("epoch-chart"))&&(k=Epoch._typeMap[l.type],null==k&&Epoch.exception("Unknown chart type '"+l.type+"'"),this.data("epoch-chart",k=new k(l)),k.draw());return k}}).call(this);
